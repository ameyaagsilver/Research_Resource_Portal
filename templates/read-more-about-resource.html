{% extends 'base/base.html' %}
{% load static %}


{% block content %}
        <!-- Start: Page Banner -->
        <section class="page-banner services-banner">
            <div class="container">
                <div class="banner-header">
                    <h2>Resources</h2>
                    <span class="underline center"></span>
                    <p class="lead">Find all the resources available here . </p>
                </div>
                <div class="breadcrumb">
                    <ul>
                        <li><a href="{% url 'home' %}">Home</a></li>
                        <li>About the resource</li>
                    </ul>
                </div>
            </div>
        </section>
        <!-- End: Page Banner -->

        <!-- Start: Book & Media Section -->
        <section>
            <div id="content" class="site-content">
                <div id="primary" class="content-area">
                    <main id="main" class="site-main">
                        <div class="books-media-list">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-9 col-md-push-3">
                                        <br><br><br><br><br><br><br><br><br><br><br><br><br>
                                        <div class="books-list">
                                            {% if resource %}
                                            <article> 
                                                <div class="single-book-box">                                                
                                                    <div class="post-thumbnail">
                                                        <div class="book-list-icon yellow-icon"></div>
                                                        <a><img alt="Book" src='{{ resource.image.url }}' class = "prod-image" style="object-fit:scale-down;
                                                            width:300px;
                                                            height:auto;"></a>   
                                                    </div>
                                                    <div class="post-detail">
                                                        <header class="entry-header">
                                                            <div class="row">
                                                                <div class="col-sm-6">
                                                                    <h3 class="entry-title">
                                                                        <a>{{resource.resource_name}}</a>
                                                                        {% if admin %}
                                                                        <form action="/resource-history/" method="post">
                                                                            {% csrf_token %}
                                                                            <input type="hidden" value={{resource.resource_id}} name="resourceID">
                                                                            <button type="submit" class="btn btn-dark-gray pull-right"><i class="fa fa-history" aria-hidden="true"></i></button>  
                                                                        </form>
                                                                        {% endif %}
                                                                        <hr>
                                                                        
                                                                    </h3>
                                                                    
                                                                    <ul>
                                                                        <li><strong>OEM</strong> {{resource.OEM}}</li>
                                                                        <li><strong>Resource ID:</strong> {{resource.resource_id}}</li>
                                                                        {% if admin %}
                                                                        <li><strong>Unit cost:</strong> <i class="fa fa-rupee"></i> {{resource.unit_cost}}</li>
                                                                        {% endif %}
                                                                    </ul>
                                                                </div>
                                                                <div class="col-sm-6">
                                                                    <ul>
                                                                        <br><br><br>
                                            
                                                                        <li><strong>Quantity/Licenses</strong> {{resource.quantity}}</li>
                                                                        <li><strong>Type </strong> {{resource.resource_type}}</li> 
                                                                        <li><strong>Department </strong> {{resource.department_name}}</li>                                            
                                                                    </ul>                                                                
                                                                </div>
                                                            </div>
                                                        </header>
                                                        <div class="entry-content">
                                                            <p><strong>Location</strong> {{resource.location}}, {{resource.department_name}}</p>
                                                            
                                                            <p>{{resource.about}}</p>
                                                        </div>
                                                        <!-- <footer class="entry-footer"> -->
                                                            <hr>
                                                            {% if admin %}
                                                            <form action="/issue-resource/" method="post">
                                                                {% csrf_token %}
                                                                <div id="autocomplete{{resource.resource_id}}" class="autocomplete">
                                                                    <input type="email" name="emailID" id="autocomplete"
                                                                        autocomplete="off" placeholder="Email ID for issuing" required></input>
                                                                    <ul class="autocomplete-result-list"></ul>
                                                                </div>
                                                                <br>
                                                                <input class="btn btn-dark-gray" type="submit"
                                                                    value="Issue"></input>
                                                                <input type="hidden" value={{resource.resource_id}}
                                                                    name="resourceID">
        
                                                                <script src="https://unpkg.com/@trevoreyre/autocomplete-js"></script>
                                                                <script>
                                                                    new Autocomplete('#autocomplete{{resource.resource_id}}', {
                                                                        search: input => {
                                                                            console.log(input)
                                                                            const url =
                                                                                `search-email-ids/?emailID=${input}`
                                                                            return new Promise(resolve => {
                                                                                fetch(url)
                                                                                    .then(response => {
                                                                                        console.log(
                                                                                            response)
                                                                                        return response
                                                                                            .json()
                                                                                    })
                                                                                    .then(data => {
                                                                                        console.log(data)
                                                                                        resolve(data.data)
                                                                                    })
                                                                            })
                                                                        }
                                                                    })
                                                                </script>
                                                            </form>   
                                                            <form action="/update-resource/" method="post">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="toUpdatePage" value="YES">
                                                                <input type="hidden" value={{resource.resource_id}} name="resourceID">
                                                                <button type="submit" class="btn pull-right"><i class="fa fa-edit" aria-hidden="true"></i></button>  
                                                            </form>
                                                            {% endif %}
                                                        </footer>
                                                    </div>
                                                    <div class="clear"></div>
                                                </div>
                                            </article>
                                            <hr>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>
    </section>
        <!-- End: Books & Media Section -->
    <div class="row">
        <br><br>
        <section>
            <div class="center-content">
                <h2 class="section-title">Related Links</h2>
                <span class="underline center"></span>
                <p class="lead">Tutorials, documentations and links related to the resource</p>
                {% if relatedLinks %}
                    {% for link in relatedLinks %}
                        <a href={{link.url}} target="_blank"><h3><i class="fa fa-link"></i>  {{link.heading}} </h3></a>
                        <br>
                    {% endfor %}
                {% else %}
                <h3>NO RELATED SEARCH LINKS FOR THIS RESOURCE!!!</h3>
                {% endif %}
            </div>
        </section>
    </div>
        <br><br>


{% endblock %}